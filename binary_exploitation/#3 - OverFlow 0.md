# OverFlow 0
100 points

### Description
*"This should be easy. Overflow the correct buffer in this program and get a flag. Its also found in /problems/overflow-0_0_6d0c88d7d40bc281760b515cb6a4660a on the shell server. Source."*

### Solution
The source code provided for the program we want to exploit looks like this:
```C
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  fprintf(stderr, "%s\n", flag);
  fflush(stderr);
  exit(1);
}

void vuln(char *input){
  char buf[128];
  strcpy(buf, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n");
    exit(0);
  }
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  
  if (argc > 1) {
    vuln(argv[1]);
    printf("You entered: %s", argv[1]);
  }
  else
    printf("Please enter an argument next time\n");
  return 0;
}
```

Let's look at what this program does. I'm just going to go over the main functionality that is related to our exploit.

This program starts by opening the flag file (which we don't have read permissions for) and copying its contents to the `flag` buffer. Then, it checks for command-line arguments, and, if there are any provided, it runs `vuln()` on the first of these arguments. If there are no command-line arguments, the program tells the user to run it with an argument next time, and exits.

`vuln` takes a string as input and copies it to a 128-character buffer **without** checking that the string's length is less than or equal to 128 characters. `strcpy` does not check either. **This** is the vulnerability we must exploit.

To understand why this is a vulnerability, we need to first discuss some of the lower-level concepts of program execution.

#### The Stack


<details>
  <summary>Flag:</summary>
  
</details>

[Next Problem]()

[Return to Binary Exploitation](https://github.com/sdvickers98/picoCTF-2019-Walkthrough/blob/master/binary_exploitation/%230%20-%20Binary%20Exploitation%20Homepage.md)

[Return to Homepage](https://github.com/sdvickers98/picoCTF-2019-Walkthrough)
